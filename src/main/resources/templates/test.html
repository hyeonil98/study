// ğŸ“ public/index.html
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê³„ì • ê´€ë¦¬</title>
  <style>
    button { margin: 0.5em; }
    #statusMsg { margin-top: 1em; color: green; }
  </style>
</head>
<body>
<h1>ë§ˆì´í˜ì´ì§€</h1>
<button data-action="delete-account">ê³„ì • ì‚­ì œ</button>
<button data-action="logout">ë¡œê·¸ì•„ì›ƒ</button>
<button data-action="ss"></button>
<button data-action="toggle-notify" data-user-id="123">ì•Œë¦¼ ì„¤ì • í† ê¸€</button>
<p id="statusMsg"></p>

<script>
  document.addEventListener("click", (e) => {
    const el = e.target;
    const action = el.dataset.action;
    if (action) handleAction(action, el);
  });

  async function action(action, el) {
    const actions = {
      "delete-account" : async () => {
        if (!confirm("ì •ë§ ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
        const res = await fetch("/api/account", { method: "DELETE" });
        if (res.ok) {
          alert("ê³„ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
          window.location.href = "/goodbye";
        } else {
          alert("ê³„ì • ì‚­ì œ ì‹¤íŒ¨");
        }
      }
    }
  }

  async function handleAction(action, el) {
    const actions = {
      "delete-account": async () => {
        if (!confirm("ì •ë§ ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
        const res = await fetch("/api/account", { method: "DELETE" });
        if (res.ok) {
          alert("ê³„ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
          window.location.href = "/goodbye";
        } else {
          alert("ê³„ì • ì‚­ì œ ì‹¤íŒ¨");
        }
      },

      "logout": async () => {
        const res = await fetch("/api/logout", { method: "POST" });
        if (res.ok) {
          window.location.href = "/login";
        } else {
          alert("ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨");
        }
      },

      "toggle-notify": async () => {
        const userId = el.dataset.userId;
        const res = await fetch(`/api/users/${userId}/toggle-notify`, {
          method: "PATCH"
        });

        const msgEl = document.getElementById("statusMsg");
        msgEl.textContent = res.ok ? "ì•Œë¦¼ ì„¤ì •ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤." : "ë³€ê²½ ì‹¤íŒ¨";
        msgEl.style.color = res.ok ? "green" : "red";
      },
    };

    if (actions[action]) {
      try {
        await actions[action]();
      } catch (err) {
        console.error("ì—ëŸ¬ ë°œìƒ:", err);
        alert("ì˜ˆê¸°ì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      }
    }
  }
</script>
</body>
</html>


import { handleAction } from './scripts/actions.js';


